<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>晒单</title>
    <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, width=device-width">
    <meta content="telephone=no" name="format-detection">
    <link href="css/common.css" rel="stylesheet">
    <link href="css/shaidan.css" rel="stylesheet">
    <script type="text/javascript" src="js/jqbase.js"></script>
    <script src="js/jquery.min.js"></script>
</head>
<body>
    <div class="shaidan-wrap">
        <form action="">
            <textarea name="" id="" cols="30" rows="10"></textarea>
            <div class="sc_pic">
                <ul class="pics">
                    <li class="inli-wrap">
                        <img src="images/sd-pic.png" alt="" id="file_img01">
                        <input type="file" class="file_input01" multiple="multiple" accept="image/*">
                    </li>
                </ul>
            </div>
            <div class="sd_btn">
                <a href="#">晒单</a>
            </div>
        </form>
    </div>
    <script type="text/javascript">
        $(function(){

            // 上传照片开始
            $(".file_input01").change(function(){
                var objUrl = getObjectURL(this.files[0]) ;
                console.log("objUrl = "+objUrl);
                if (objUrl) {
                    var newLI = $("li").eq(0).clone(true);
                    $("#file_img01").attr("src", objUrl) ;
                    var len = $('.pics').find('li').length;
                    if(len ===1){
                         $('.pics').append(newLI);
                         if(('.pics').find('li').length===4){
                            ('.pics').find('li').eq(2).remove();
                         }
                    }
                   
                }
            }) ;
            //建立一個可存取到該file的url
            function getObjectURL(file) {
                var url = null ; 
                if (window.createObjectURL!=undefined) { // basic
                    url = window.createObjectURL(file) ;
                } else if (window.URL!=undefined) { // mozilla(firefox)
                    url = window.URL.createObjectURL(file) ;
                } else if (window.webkitURL!=undefined) { // webkit or chrome
                    url = window.webkitURL.createObjectURL(file) ;
                }
                return url ;
            }
            // 上传照片结束
            //dianji tian jia tu pian

            // $('.pics').on('click',function(){
            //     var str = '<li class="inli-wrap">'
            //             +'<img src="images/sd-pic.png" alt="" id="file_img01">'
            //             +'<input type="file" class="file_input01" multiple="multiple" accept="image/*">'
            //             +' </li>';
            //     $(this).append(str);
            // })
        });
    </script>
</body></html>